// Copyright 2020 IOTA Stiftung
//
// Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with
// the License. You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on
// an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and limitations under the License.

use crate::milestone::{Milestone, MilestoneIndex};

use bee_crypto::{Kerl, Sponge};
use bee_signing::ternary::{
    normalize_hash, MssError, MssPublicKey, MssSignature, PublicKey, RecoverableSignature, Signature, WotsPublicKey,
};
use bee_ternary::TritBuf;
use bee_ternary_ext::num_conversions::{tritbuf_try_to_i64, TritsI64ConversionError};
use bee_transaction::{
    BundledTransaction as Transaction, BundledTransactionField, BundledTransactions as Transactions, Hash, Payload,
    TransactionVertex,
};

use std::{convert::TryFrom, marker::PhantomData};

#[derive(Debug)]
pub enum MilestoneBuilderError {
    Empty,
    InvalidSignature,
    SignatureError(MssError),
    InvalidIndex(TritsI64ConversionError),
}

// TODO are stages really needed since it's internal ?
pub trait MilestoneBuilderStage {}

pub struct IncomingRaw;
impl MilestoneBuilderStage for IncomingRaw {}

pub struct IncomingValidated;
impl MilestoneBuilderStage for IncomingValidated {}

pub struct StagedMilestoneBuilder<E, M, P, S> {
    hash: Hash,
    index: MilestoneIndex,
    depth: Option<u8>,
    transactions: Transactions,
    essence_sponge: PhantomData<E>,
    mss_sponge: PhantomData<M>,
    public_key: PhantomData<P>,
    stage: PhantomData<S>,
}

pub type MilestoneBuilder<E = Kerl, M = Kerl, P = WotsPublicKey<Kerl>> = StagedMilestoneBuilder<E, M, P, IncomingRaw>;

impl<E, M, P> StagedMilestoneBuilder<E, M, P, IncomingRaw>
where
    E: Sponge + Default,
    M: Sponge + Default,
    P: PublicKey,
    <P as PublicKey>::Signature: RecoverableSignature,
{
    pub fn new(hash: Hash) -> Self {
        Self {
            hash,
            index: 0,
            depth: None,
            transactions: Transactions::new(),
            essence_sponge: PhantomData,
            mss_sponge: PhantomData,
            public_key: PhantomData,
            stage: PhantomData,
        }
    }

    pub fn push(&mut self, transaction: Transaction) {
        self.transactions.push(transaction);
    }

    pub fn depth(mut self, depth: u8) -> Self {
        self.depth.replace(depth);
        self
    }

    // TODO add address func

    fn validate_signatures(&self) -> Result<(), MilestoneBuilderError> {
        let mut signature_buf = TritBuf::zeros(self.transactions.len() * Payload::trit_len());

        // TODO impl Iterator ?
        for index in 0..self.transactions.len() {
            signature_buf[index * Payload::trit_len()..(index + 1) * Payload::trit_len()]
                .copy_from(self.transactions.get(index).unwrap().payload().to_inner());
        }

        // Safe to unwrap `transactions.get(0)` since we're sure it's not empty
        // Safe to unwrap `self.depth` since we're sure it's not None
        let public_key: MssPublicKey<M, P> =
            MssPublicKey::<M, P>::from_buf(self.transactions.get(0).unwrap().address().to_inner().to_buf())
                .depth(self.depth.unwrap());
        let signature: MssSignature<M> = MssSignature::<M>::from_buf(signature_buf).index(self.index as u64);
        let hash = self
            .transactions
            .get(self.transactions.len() - 2)
            .unwrap()
            .trunk()
            .to_inner();

        match public_key.verify(normalize_hash(hash).as_i8_slice(), &signature) {
            Ok(valid) => {
                if valid {
                    Ok(())
                } else {
                    Err(MilestoneBuilderError::InvalidSignature)
                }
            }
            Err(e) => Err(MilestoneBuilderError::SignatureError(e)),
        }
    }

    pub fn validate(mut self) -> Result<StagedMilestoneBuilder<E, M, P, IncomingValidated>, MilestoneBuilderError> {
        if self.transactions.len() == 0 {
            return Err(MilestoneBuilderError::Empty);
        }

        // TODO check coo address
        // TODO check bundle structure
        // TODO check depth
        // TODO check last address is all 9

        // TODO remove clone
        // TODO test invalid index
        // Safe to unwrap
        self.index = tritbuf_try_to_i64(self.transactions.get(0).unwrap().obsolete_tag().to_inner().to_buf())
            .map_err(MilestoneBuilderError::InvalidIndex)? as u32;

        self.validate_signatures()?;

        Ok(StagedMilestoneBuilder::<E, M, P, IncomingValidated> {
            hash: self.hash,
            index: self.index,
            depth: self.depth,
            transactions: self.transactions,
            essence_sponge: PhantomData,
            mss_sponge: PhantomData,
            public_key: PhantomData,
            stage: PhantomData,
        })
    }
}

impl<E, M, P> StagedMilestoneBuilder<E, M, P, IncomingValidated>
where
    E: Sponge + Default,
    M: Sponge + Default,
    P: PublicKey,
{
    pub fn build(self) -> Milestone {
        Milestone {
            hash: self.hash,
            index: self.index,
        }
    }
}

#[cfg(test)]
mod tests {

    use super::*;

    use bee_crypto::CurlP27;
    use bee_ternary::{T1B1Buf, TryteBuf};

    fn generic_validate_milestone<S: Sponge + Default>(
        ms_hash: &str,
        ms_tx_array: Vec<&str>,
        depth: u8,
        index: MilestoneIndex,
    ) {
        let ms_hash_trits =
            Hash::try_from_inner(TryteBuf::try_from_str(ms_hash).unwrap().as_trits().encode::<T1B1Buf>()).unwrap();
        let mut builder = MilestoneBuilder::<Kerl, S, WotsPublicKey<S>>::new(ms_hash_trits);

        for ms_tx in ms_tx_array {
            let ms_tx_trits = TryteBuf::try_from_str(ms_tx).unwrap().as_trits().encode::<T1B1Buf>();
            builder.push(Transaction::from_trits(&ms_tx_trits).unwrap());
        }

        match builder.depth(depth).validate() {
            Ok(stage) => {
                let ms = stage.build();

                assert_eq!(*ms.hash(), ms_hash_trits);
                assert_eq!(ms.index(), index);
            }
            Err(_) => unreachable!(),
        }
    }

    #[test]
    fn validate_milestone_mainnet_1363619_test() {
        const MS_HASH: &str = "AVVTI9AB9HFVGKGDQCXHJQEJDOYHZRFDRAMABMPXUUB9XSMRTENHFMOPQDZRQQUAZHIVYRXBYWJK99999";
        const MS_TX_0_TRYTES: &str = "JLXZXQOGYIASGXHPPTXQGFKPVXKAZKCRHRSY9AXHPCKRPCDYUACNLVAMUMVEGSUYCSFMNEYZKCZHLNSPZWQEEDYVEUWDHEHXCHQAA9YOEZKETHZTMXDOFAIXXLXXZHJDS9VRHOATUCBBSREMXBBGBMYJYBFJRU9CWZF9VX9LIXMPRILZXZHFJJQRDGXEWGECKD9FOEAELQADYLZAGIDHJVJPQUHZEAVPAZLQJNIWCAFTPMDCKPWNZXVXWQLFLHJSPWCBWQWKAPKOQYFIFIIZHDDEQVPVYIUHBWWT9HAITJXNQUSWCEMTMABQLE9WLCLSXOUZKLVRJM9UAGYVMTYBIOIWDBEOTAV9FGHFRRKRECBQEUGEJVONMHQSDWLRUCCYCRUZWBVMMIIAOTZUTQLNAHJOZDZAICZTKYNYFXRLUFGH9CLSWDF9HIKK9UKFE9USTCYEWNIASWIHEGJKXUEGNFBZGNXTWEZICQRLW9TFIXJIFHHMRPLVIHAOZTZISZTRQJDAINKUCISDFJBKBRCVEJITIBQGMCLWEZVUSGKIHO9HIVDKDEHVNWAXOQNXUDCXESDBELFFNAOHSWPJSUEGLSYURUCJOWQPIOVYRMKHN9FVRAGWGZPZAKDFYLXICBXDLHGLJLLCQUVIAJZZTXNFGHKACZNGPPTEAFMMUAYDSOXVIZFCVGQHVNCRMSWGCLHKBEJDZQFBWSYPSNPEETARJLRD9NGPRTEWTFNFNJNTK9KSUIOMXWZFLOTIMWMYUBRGLYGXAQIFOZ9EEATXNCFRST9CLNZVQQEKMNIFBYZSYXWYWEFVRJQUFATHAICNPXYIRJQUIDEOLFXVSIETMIZLSFLKTZBPZVNSMFVLJYEARBICCHPXEHMES9DM9BYVWFSNWCPPIHNUYFVPOBKBDAYNZUZAUUYKVYQDGL9TGIXKCJQPRPWQQJGNTCAIFWVJZZLVJXTHDOWAHRRBANOAUTNCBIXHHVBZNZEOLZQYCVTGXL9CPOWQD9WEIWQNHPUCSGFFYWVOQGAETAHDNYDVXXTQMGFYPAXNCN9RU9XSHNXCHVYLF9ARIKLXUEYMZUAJZP9BVQHWB9YCZQFMUQRUJQS9LUNOFWMMCCSASGLTYOBDCHDIOBJBOONQHBLGVZIKGWUFLSOYARYTWZSSOXTOXJWURWGEHMSTDUWUGSSXUINDKJVG9FWBFPFBXYEGVHHAPVYQ9BHEWUWBGHDCOCBMI9SLNXPESCCKSOXQLWCYOLLZEQDJLQYYEZRNISRCTLEXHBXGCHSZSKGUYEEWV9HA9AXJSSXMRTPBDFKGVGNWJOGMBOZYNYUNQQLDGISIHKGQBFZBPQXBJBOFKDWABSZFFBWSNWKJBQSOOFZHZNLBIZVRJLAPRGXEHADIDCNEDVMYFJAYHBWTPYFKBRVP9JNZZESBWBNHQQFOEZSUVXJEOIIPVEEZISRSXBHDQAHRJ9X9EMNZLEUAPSUKWJAPPGEZUHFMUHPGVTLBAZPRA9AUFTCPFPQTUNPQEIODTYQIBW9GOIEKJHBNHJILNKBUZKZJHWAIDFVSNJSRXPYCYTZDBRUJEBTVBJJWTGLSKPI9YNQPNFKDPNI9MCNRV9SOJGRICKPYTOTJQZTIHKCIQWQMXZTKOVOMNXPEWPNVUYDXAYXX9ZHEVLCYIRHETNUSKLBDKUWISIKSFERPHXXSF9KFDNKQVUFGPGHMBMIHFZX9ZKRPYULRFDJUSIODHWXZJUMZDQCZB9TJ9PISMZRUNZZREFKTUSYMZRVQFBGVWXBOTMBTVXJMPFRGLNPGRSEJIFEQFSERMCUFCEFFOOMASJWROYWAWTQBBVGCDXTVEHLVYHGGBAIQCYQSCVDGAML9DMAEYOSVFNALCI9KHWCCMDTOANJLZFDIWDCWTQBSCLXCNMYKVQCYTSVMKQYGNLIF9DTPDWG9PYVYWALXQK9PUQOITCDWCYNTKNASGRJUSZNHF9FNYBKWAWLTDMBEDVOQCYSTDM9RIWRKCDTUJNCLKEZPDSMJYKOMHY9MYCSMQBHYGLHDHPKJZHGOQSIKEJILZFYFI9IYIYZ9QCDGC9PLJGRLYVWV9FDMKQNNWANMEUCWIX9OSOX9EDMCDJUQHJKKEYJXRWADQILCIYAOCEVSUAXAZOXHLGWCWO9DBQADSMHOJBN9RQGMDWUCLSBFTOWEQSAUZXULTTYZCLNJNTXQTQHOMOFZERHTCGTXOLTVAHKSA9OGAZDEKECURBRIXIJWNPFCQIOVFVVXJVD9999999999999999999999999999KNHOC9999999999999999999999AYUQNCD99999999999B99999999ZNTINGHMSWDSSERUUKBHLVWHQZAP9XYRCBEINKT9PSXSXKFHNWKCJUOYCMWMMVJKCG9XFZBOWGZSNUKAA9DWAZGXZGOLPXMAWXL9KOXRKWUWDYCJNYDDUCPXHZIFTFMRMZODYUHSNDFVTDHAGDBHBHECZJFQU99999CTAQFROZJTBEOKBN99WRDGDZPLVNXMSFFYVSVAFTQDJVRWFHVEWOKSJOQESMRBFTVDNIXDZRKSACZ9999KNHOC9999999999999999999999SJLHMTPQF999999999K99999999WBD9999999RSL99999999999999";
        const MS_TX_1_TRYTES: &str = "DFTZFZXAXTVBQMPZONBZDOD9WBBBWQS9PQLTBWEAXFPKYWNMS9JAGOJTRQNKHMGERQVGOFKCQUZFFXGADPYQQUIRDSEREWLFFVMDFEVCCYUCKULRQZBMOALWUBAASAGJPVJVSXXHTLIEQVZVXIANEMIMV9FAESZKFCBPYVEALZGYAYADOJLMZJFR9WUGZDWKZUNZMQDY9MTTPGMPLNB9LKEBPMKVYKNJTB9YBHEOETJDEYYRIWAXHEDLCVIZJKB9HLGCNJXXUWCECTHDYNR9EJXRWFQCAFYRAHGFSSGYGIQYIRYFSZITCQNMLGUDXGSWOFKXLYYRPXB9S9WPDCRHBLXALJAJKORGTVCSCNRAMBTCSNLXRVDDTAQLXKLUOL9HH99DDFHNJYCOYZHRDYYHZMXFRKPHGBLWRPPFQWBNQCLVWFORWZPROYZHCRY99ZVFOEB9JYXDHLCBXFEIGBRVZPZYHDHU9FPDQZSXVCZTQUKBK9TUPGGQBAOIUVAXAUEIEGMMNEDJAESRRPHYKXG99DYNOLQFVWLJINMTGGYGQO9TYZXFTKSZBAXFVJODOETNARWKCMRZTGYGYBLKSFHWPHJXCXD9FPBJUJYJSCNLOIXAGJB9OWTLDBWWCYAJTALKDSHYDGHWNBUIAYVBAIG9BTPMKB9BGHHTVNEKXKOSRRJTZNCEOTDIFONNBMRYKNMOSWKPOIERXJPMCTOCMBTQRHXUZMPPOIKRCI9VGCWXQCWKSWIKB9NAQJNZREPQWXOCVMZMGFSORUUDMEJMESYNLNLRNRRNPNZKS9IWQVHKJDPETTGEIDAXLMTEEMJIONWLZILGWMGQWQWJLJJVHHI9PHQGPTHBOWY9DGZJJIPRRLBWPDSFTRLRQLNC9WX9L9YWSHLUUJKVDMPNRLXPPQFSTKRRVGCAGB9SYAHQLPXZRJRDRJTMXRDJ9ODBTFGXNHYKSKURKMQWVIXZYFIEJAYXSAOTNJUSHAIORJBVPEMHEIEYACFPGWKYRBTTOMGFQFNBCXNVJYUUBDSTXKHMUSRJGWFAHWSUWSBQRVCGANNYCLWFONQGOQWKRCI999IRV9WIWXFK9UIEGKCOKARP9OTCDDVNDEJPQS9IDEYUPTURWVALCCQBEFOV9WXGWRLAHTRNEKIXSPTOHLRADBUAKTNHEOBJEEJDRMCNSWNDISQETGPDTYGNBKRRXRGBJCGSKZZKDLJYZFZEVNHTUU9DNNQTFUELEDZGJT9RDMIKUTRXYDLNBDDMZWHJWKCSVQZLKAWMZYII9QNLGDVOZ9FZFACEYDZB9JNSKAJAWNKUEMXZVUURZDJFBLCHPWEKFTYIYGDNZHWFJONBNQHLAAVAIFEZZMJPYSWMHZKRWHVDVGVKMEJMPWYPB9AFNPKKFLYIFETHXHSRFR9GWMTGSMVZBWMQDOUTZAYEAUHRIXPBCXLYBMFLVLMXND9THGBZJPJANUABRSQHRJOOQOEJAOALRDEMOBMMRTCRXJFXGHVLHJUZGXFE9XGVOKPVCTVZZACMRCCBONDGHFSURRASAJFSZBGQGYTWXSRNSHMBWEUNRXCXCO9ZVJLGWKKABUXKISVKGCIZUOXTTBECUZHVPOETUEIZAVZF99IUOQKEF9QTI9LLBJSYUGINUG9OJWPLCDUFURHFCVMSDEXVQLQFRGCZADSVAQJTVOQYBTYTKZAI9L9ZHIWQHMRNDAJSVXRBPWWMUKWWPOADAFKL9CMUFJXLHTYNWTLOXODDMVOLNCJBEXCWMSSHDKSTXM9EMXSAXKXWSTBCCSSMX9MUPBAYPLOOMAY9YREDWJYKKHZDQXLZQVPF9EAYESD9RBGOPARKYGVBFGGMNTQYPHWKZJVRDRSWIT9VFAB9FWAPXMYAEKEM9EVDT9YCXSSJTEWEAZPXIRWIGMJY9QSXRNANFQDLHNZQXCVADJJDMAUJCLUGUDUBOTYMUIRRCGCHUOPRLCJUDYXXFSIKJCMTWCUOHFMQCF99ACQYJPREY9MOEGMGDJPCGYASCIBATAKJIZCOIRUDZIYKVYWKMWSSCBT9TCBCGYZPKLVHCXOSSBHJSPDRYJTEAMFXHTBEJLYCHXJVUQIACWREQXUBUI9EDEYKGJADCJDLPAGMO9GWQOGBUSBSPTWFIFHOKMKWJKHZVX9PGKOLBTLIZV9LMFKDUHENUQDEQSAUZXULTTYZCLNJNTXQTQHOMOFZERHTCGTXOLTVAHKSA9OGAZDEKECURBRIXIJWNPFCQIOVFVVXJVD9999999999999999999999999999KNHOC9999999999999999999999AYUQNCD99A99999999B99999999ZNTINGHMSWDSSERUUKBHLVWHQZAP9XYRCBEINKT9PSXSXKFHNWKCJUOYCMWMMVJKCG9XFZBOWGZSNUKAAJMTCM9HFZHIIWJCP9TRBIVLHVTLBWESJUNXYS9FWJTEAYXPWHWIEHFOJ9Q9ZBADGTSIRCUSFTLPK99999CTAQFROZJTBEOKBN99WRDGDZPLVNXMSFFYVSVAFTQDJVRWFHVEWOKSJOQESMRBFTVDNIXDZRKSACZ9999KNHOC9999999999999999999999HWLHMTPQF999999999K99999999KFC9999999XZG99999999999999";
        const MS_TX_2_TRYTES: &str = "UFI9GAMLPDRND9DCGEXVMDYHEGRJTUZJLLCXRNZJJCZKOBTOQSZVJMIAMTSDSBRTUMAWYJVSRSWAIRHQWABSUS9ZZMMNBUGQWMYHFUSJQDVUNBLJILFZKZJNEZDTOEGXONHEUUKAW9QZUCTBVOEEFCROLJYFWKILODMGGUIOXBXLWLFDILWCQQKNBXCALYQUSIVFMNWWZNSBHRPNAXJIZDASJHVICHVMADPLRDAMMGPUKCGARSBAIFKBXYURFCRBBVXOCJQKRQQAAWCBLGAMHLKHELXEBWCCQLBRJRDKUYIWGMWEJ9SKSXGICORHSJQTFRCDMDALNFRFNJCGQOOJLQYHYUGCMKOGNIUNRUMKYZAWPZTOKERKPMQILYLOPIINAM9SRWXINAWNMQEMHDFIDFNYZRL9BCUAPMHFQXIPNWJNTXYXTUNNFCA9HZOLCXOPFPLDLLXRXSMKJHYLBGCEYI9NLN9DLCPRLFILJCJFOEXPEDPYAMWMWYZSRKULCHWUCAZCSILSPLCJGISFOCAGJZSZALOCDNCXOANM9BNBOXUVRXCJRSJWRCX9SW9GFXLPTHHJ9HYYTUMQMBHSHOMBASYQOLHSVKUNZWUNVGTACKXNBASLEKNXITODWICCVUNWEFHMMMQYTL9CVBQGSWWXBYPHO9DGDSMYYSBZQPOJXBE9SKFALGPMZQAEQHDKHZMUMVLSSCIXOCXZH9XFMCFTGQKODJNAUBQDSMHISXAMKTYGWPRFKKHSCDGWCJEFDBKTTKVXTYGVUJAOHRINHGUDLFIKMZBHFEHBGBUWBHZCRYXALHBKQFVWGDBSAQUWWMOTKYKBWVZYLLLLGQDTMZGYPWQLIUHCFKZOIPHOGSKF9HSCQIBWFYHIMFTGDUCCXWRJWJNDJDJHSOWYMUIPEKOVQOEVBX9ZZTGBUIALRXDQGSASEMI9NCZK9VPVCYNGJSSPUIBAVHIUBVWZETHWDNGLVSCUXFWZYFIXLW9ODYHGGQCPJVNBJUNMV99SUQSEENLH9LCH9EXGEFPFBYHBCUDANSGHVIHRWBFXLJOYYFNQQXGSBQCATYEPMFLJSPUGXXNLXWHLA9PPKDODBJBELVTCBSBPCMYHTJNVAHMVFQAWEQQGUYPTCD9ZXXSI9MZUYLUJXQ9GFNLIQUDMAIQPBPZTRZKAERMZZKKJZZUMVMBXAGMPSESKRWUIMMMCN9CLAOCKQFOGNMACWYLEIRNKUAB9IIWUIKYHPGTRITMXFNJWDJDFWKCRRWZJSUYJDCEEJHVEJZWFPQLNTK9SIINXNFOI9DJEGMRRNFUZMSGKZZWXPRY9PQPQPLNRBDX99JBNZZGPYDNRDHEYKMZVYUIYVLKQHGYHFEFC9LMKYJWQQQZVYVMFQDEKYPE9RETZN9BMXFBGVPDKNSWSCNFHVPPBVQKWMKCQEOWGURJIKCXFDSSJDLGQHQ9WQ9KUNBAAQAUPBGLGGBIKANVDLGHFHKJQEOWKXV9TZQEXZZZUFOAC9ZOVPKTQZZASSWCTSLGQCPPBATPLMRXBLBCNXZTGFFNCMAUIZDRADNH9VGTP9LXNTSKCULPS9AYEMCWXFCLGHXHIGORKZGMEXLD9DOAZWLHXGYUWQAHOEGDSHTYUSGLI9OGFWIQTIAWAIA9TNVOZ9REWUPCZJEXAS9IDSYOJ9VDTAIOXHLEIOKNXUPNZ9DVOXRZXYOBKWARQLVCWIIDTUAFOYRYCIKAQCRSIXDDJYRKUD9RAVIUWJHXQYVCENPAIS9SACTKEOANWDJEJRDSFPIPDMSWFHUZ9VXIDGULVZOCOUDZEHFWPTUJDES9KGFHXTYZMQMEMZ9KQVD9JDHPOJKICKYSTGGQPDV9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999AYUQNCD99B99999999B99999999ZNTINGHMSWDSSERUUKBHLVWHQZAP9XYRCBEINKT9PSXSXKFHNWKCJUOYCMWMMVJKCG9XFZBOWGZSNUKAACTAQFROZJTBEOKBN99WRDGDZPLVNXMSFFYVSVAFTQDJVRWFHVEWOKSJOQESMRBFTVDNIXDZRKSACZ9999BOOGETCQNX9VOSRCZEYUNSOFCJZNCYMNQMBHNLLTIWGPOSAEPNWVODBCHSDDDBUYNQUHDPUYUUWGZ9999999999999999999999999999999UVKHMTPQF999999999K99999999ITGA999999IVWE9999999999999";

        generic_validate_milestone::<Kerl>(
            MS_HASH,
            [MS_TX_0_TRYTES, MS_TX_1_TRYTES, MS_TX_2_TRYTES].to_vec(),
            24,
            1_363_619,
        );
    }

    #[test]
    fn validate_milestone_mainnet_1367702_test() {
        const MS_HASH: &str = "XXTVQZZITJJEHHKELOUEJWRQGULGLGREFUFFMRSJEDADFCJPNCVZBBKNWHYIENHBBWWUUHIUPNBB99999";
        const MS_TX_0_TRYTES: &str = "MBAVMDYRVLOJCP9XSYBQPHUWNPNDTNKMLJARNHRMLLHUYCQHHMRFKCYUOFKBDURQJCXGX9XPWHAAD9PXXQXXLZ9HCXCEIGUNKPDSVQGIWRORQOUOJBYGKWWOLU9NLOOE9EMIUYGQSWLIIFNYJAZJ9RKRRIEXIGMNUBLIQJVNLP9QEEARGGMIRMC9XPKQIAFXNUMVQ9NEIJZDW9LX9XFJAJSNGQTCEDDOCWTKUEWYXVHLBFIEBHABPNYXZGHHDVRNVLWTPESJZNE9UCYAQJHEFTFKHCNQAKJZNYHKVJWYFSQTCLRTXXEYBJAJSGAYKBPQAXUA9XHFGZHZMSHHNNENEGMVFCXJOINLSFZJAILSABHIMXCVJIRVTRH9FNOILRPKROUUCTDGCHQNCHZZKOUHAXQHEUWAFHQUIYLZZFRVEO9TITWNQARRHIWDKSAOKRFGRTNRP9CKSPZMLSCXQXVL9EOATZYHUSOXU9SRQAJZPHHARYXJZJRQPKHTWUY9LOPQJUBKLI9NMRETRUQDNADAMWRUGODYEWDBBGVDIIP9EHSSOIONCQRMCAXUJVBPKHOZLICDKMBMADJEUIEWFGPVLITZLKCUNR9FUX9VIEWXJCBTLCQJXGKHHV9MXUPMZAR9YKIKJENADUEEWDPCZZ9QFRXLHTWJRMGGFFEZUKQMMMORHMQARO9MGZAZKKRARMHEMIL9GFYMFIRQXIKYOIFEQUZPXVUOCEYYORZDHUBKABHBSHMARJMIE9SDMDNWFHKCPPIGKEWQJIWIRBNOQWTUHHTSVMNBNVXBMKIXXLQQS9RDVTVESLKAZBILMPUZPXVQVKDZXOXWMIIELKPWOLKRRTWWTMUXCHKPYWZ9YKYEEZRIBDQJHMEMCZXPIRYFSPFWWNXUQNXHXHUBOHUUVB9KOBG9C9LPYZZVKFNWECKNRHNHS9WCFYERW9HIAWPFLSXJXZACFCKFBMQAY9CNKQLRJZKFZTDVEJLTOWVMRZTEFZFUGCSJZZJGIDYSOVJPJEAWNICVRRFARZMRZWKL9IKNFPSRHDFMBPAYAXYSHCYXUEVEKCDOHOYXYN9XNMUCBHKXJIJAGUQ9Y9PIHXVVMPLGMMXBVUJYRSAAWGSIRKELKLESGAKFOMWYZHBLABWY9SFGWIZX9TTUHQSKVTXTB9LGDICRDI9UMCKYIOPZTPZSJGVGHNZAKPZZSMKKCXQFH9DUZWAJURFOYTJPPYDGAGRPFHSZUXKXBZRX9XIHKWZDALRJPAQPWAECOFZOCSJLPUYK9F9LLSKVDTFPSPA9ERMN9BWSRPNQXLNEUFWKZSMSRNXPSADLHQIJUVFEKMZOIRTMQSVCAGEPHFTGAGIRYYYJUUTLSXONNQKBDLRKPVHCQTGEHLRHNTWLORQBSUYKPCTUWKRRFYTCLRZFRAHKYIXTPNISSYTUEBQMELRMZFDMPKOQHOGNP9QLVPFIWI9TOZSXUAT9BEFHHJSBZJWMQIXPZUXQZYFOILRWRJRAIBMDPCQGCIJXTHSIAWCT9ZAYU9XPAPXKNAMHUHDWSZSZRLUREPJHHOKHVJGYNVBWZSKEAUPZCNRSONWD9LFGIVICZSZTGGVYJUTMDM9JINYMAYHWEAZZMKBSRMJZNC9TZ9EEXMWUXWLOYCRNYOXQYFGRULZKPZDBMKWSUJWRPHVFMVCDKIAQJTQTUC9B9YNQZYHBEQGGHSTXNXBATUFTSUVSWBXQMCIUMOWPEAEAFSTOBRQFAVGGRSAONFYWWRNUKNFMGYPRBYVKWRYUYZP9DUBXAXYZHKSUMPVKFZQBSO9NTPSRLFXNBKVEGYYXIMOMOETKZMLQDPUXOBDNRENNLQGDCBGGEKC9XLZLLAESAAIKNDDQDJPWTFEHNRZWTWDQIPE9UWDP9LXLUHT9EUZKGRBDLRBMOFIRQWCBFJYEEIJTMWAMTAVZY9CPFOASGHBHGAKIPJKYTQH9PYSIURSUEEJXYWFKDCCUXQCPOEOLFGCZEBIY9LGPZ9SQOUTEEVUDYAORWOKNWEGHZAYUMGFFTMRM9ASZIWFWNTQHRWMOSCDOIXAODFISFEFQVVODRBYROZEAZUCFXBKDYZLQENBNVCAXETNZRNGNSRJDBQAUA9IMLPDNLBEMKDDLLISBKUYJO9LMWYCXJOQJPW9LRURHBALMLJYJUU9PIIZRKZDEQSAUZXULTTYZCLNJNTXQTQHOMOFZERHTCGTXOLTVAHKSA9OGAZDEKECURBRIXIJWNPFCQIOVFVVXJVD9999999999999999999999999999QDMOC9999999999999999999999C9UGNCD99999999999B99999999ZFEEOXZLETROCWIVDZUOGYLJLSLIJUDHGABDQZDSWXBPPUZBZGJBJNUMTQ9RBLZSIPNANNVX9IXPHSOIDXDLRZGZZFOZUBCPVAFEZVTDWYLKUSYFWBPHNNKVXGRSKAQSIIAFNHXWAEHRKPDMGIATYYXHLXXFTZ9999XIUXCLADNORUPLPYKKZ99EXWHIQCEIHBNFVPKTOZXQWQBX9DLJWAAEFOLGCFONKCDXYOKREFNMGPZ9999QDMOC9999999999999999999999NRVCVQQQF999999999K99999999OIC9999999OPE99999999999999";
        const MS_TX_1_TRYTES: &str = "CFNLAYDDELQGYIFYDYDEXFZIHGTZWDUNSUVG9CYTEZJRIKPWYIQQZSM9JPTGXSADHAZIQUGLAPDNTMXWWUAAJE9ORZSVJFBQXDIIMFYDPZZCYPBAXZQYYUERXHAVSRTJOWAXFKEHJSKOU9HJXVRIZZNFBQXBNAWFUZVURFLVWKCASMHRKKLPC9VMOWRSPTCSVUH9DSYDWMJ9GFHXIBEHSAGEDQUUEVJQPJCGWRYCLHDYDOLLEUXVRYPMCBCGEEPUOAAD9YXMZDCHNJRKMLMAFDTFUTIVAPAGHPYQCKFFUNEPTWMOFMEHNOGBNJLZSYRAIOQZZZJ9RTMPEACLEXCSUB9N9VXGPJ9PRNJKVG9YLODFIRN9JZLUVJBYBCTQWEFLAYUKZRWGZWFA9X9B9EGZXVBMRD9UPPLG9PVDCBYKESSWHGCXXMX9DYVTWMEDADDCVS9ZOFZECLHPGXPYMWUPYEPQROLRGDN9UVABVYLBHHLIOOVVOQ9E9HULJSBESLJTJANCIMJDQWKSCKSCDKVRUAPBEWTNQEDGCGUADNEZ9DYIQGQDQKPCXQDSS9F9HZHFISSKQJZNKHXMRBHGJPEGKLBNVQDAUMMRRESOPK9MZFWGEUUTTMMMI9HHJMKHZRIFHNIHSBZXBUEZJZHQJUZ9APCJUTC9KSESFGRRYFZOXXXHINCZGUHJAPDZQERMZRXOHGHTKHLDFOCFT9FBI9GHCIBPWXZC9PHHQ9ZRYRTMXDVNBQABV9V9USBQIRKEIKCBTTSQUUIEQ9KFBDPVVEBLXOYXCKQBPRTJWWVAXMRCDAEMNELCDTTGRMGKAZDKWNBBESMRRUIBASSDJWRW9IBB9MUTBJBXQWXKXYNXAGWHEWWSUCQUZRHLBKWSIPYKDYC9YOUANH99PBHBZZFXXNMH9GTGTSWRFPCHATWMTDDOENAMGNRUVHGOLABWQJBZGTZRZZELGNGVTHXWTFCRMSWMMBIEZBRDUOZCAWHAJSFWBDOXVNFSDHGOOOS9LYNIARVFMMKIPFFCDZRHXEUOANTPVMKCYGOEBWRCZXMZZSBTIPOR9HOBGZZBN9PIMLUISBMFZSWC9YYEYKLZEIXNVIXWKJVMZGYJGITNTLHEIMIGJOFBYWGKWBXVYTNZRXWX9GAURRTPIZRRTNVLGHCHNROLGAEWBIZUUBBDPFAYYZYTE9YMFKZTFUFANZDAXHOVMYXQZDIYOAAZOEWXMHHSLUMCIFM99NFUYJZRJKOLSSUNJPEEVPLJDDOJZFBTUOEFPITCJEKHXZPINQXYSOLYBV9A9UBZZKDEWPLOBNHCSYTYWCUNKDHZJYALDCXBSGENTGMBUBBCKXTNXZZGBTONZAJKQPRYZTEICPKACVGFKOQPRLPCHAXLT9NBMLURWLMLPU9GDCAKLUYPBWVZYWDUCOQDDHUBSGCYRBI9EIVUVUAKFWKPZU9BBXRLR9IZYKZFEQFTVREZU9SCBUMVPPUIPWAVRQHEWDXIWJGLCCQSAWTXJXNYJEFDFPDVNAXBBDNGLXVDMG9HSZZATTBQTWKCMJPSMJVCVQVUZCQDKMIP9MSUSBHAKXDNOEVJDMVCUVLNYNHQIKIALBZKCPEROYICDFADLCAQ9RJZDPD9ECRCFSKKFBPAWWTKZUDCSHTWFXDHFMHDKGIHKVKHDKFIOKQORONRZ9IWVK9KVUPCYSIUCLQRJPZKUSRBWOTJMTEYNAQHTBKSYWXRNUFMRNVDHBDFGDHKEINRCZFIVDSKIPRXL99LMCEJTEIBTJPSCYG9BPCJ9FUMFJLTBJROJUOXPXFQTSIZJTGBNCGAAV9IDGLFAPE9PMGWMSASIXVVYOUOFUFPKPPJXOKEQD9CQTZNHAJAWNGQYRC9QCRCVFXSWHTSUN9OXWQDKHOHNAGMGVHJOBIEUYJQGFPCQNLMKFNVP9UWO9FHKBIBEKEYXX9BVKGVSHPRAP9JFIFQJFIAXIEBIDFUGWELLFFN9ZMTEQFGNXA9RBODNCHCUOYMEKNDACOFJOSOZDETDSBENTPZTTHZTXNENZJOJ9YTIJRB9GNTLLGDFSHHHPJUCNQXIAPUEACWLNGMXWXQBDVXA9AWLFOSFDKSEKRDKJOHKBGAZOCNVGZNHDXPRTYRPFBARNWXNZXMXIERI9DKNOTJIKVFLPJCQFJUVSTAAAPQMSBENFWEQSAUZXULTTYZCLNJNTXQTQHOMOFZERHTCGTXOLTVAHKSA9OGAZDEKECURBRIXIJWNPFCQIOVFVVXJVD9999999999999999999999999999QDMOC9999999999999999999999C9UGNCD99A99999999B99999999ZFEEOXZLETROCWIVDZUOGYLJLSLIJUDHGABDQZDSWXBPPUZBZGJBJNUMTQ9RBLZSIPNANNVX9IXPHSOIDQQVSGKJLXNDJW9TOYEYZ9VGZYLLH9DVKAYWHGTKXKQEYNSDDDXPYKTOEZYEDZCOFRLQZRJLBPKZJZ9999XIUXCLADNORUPLPYKKZ99EXWHIQCEIHBNFVPKTOZXQWQBX9DLJWAAEFOLGCFONKCDXYOKREFNMGPZ9999QDMOC9999999999999999999999UMTCVQQQF999999999K99999999EJC9999999LKVA9999999999999";
        const MS_TX_2_TRYTES: &str = "RCZEYQSKWVGUYWXNNJKKUKCWWFEOKQSKEKIKINSTTGLNFFOPFE9MNMQLTPTXAEENQJTD9BBIAAAIKKSKWQBQRQBPDPLAEHJNMHCPSDIBTQWADRGWLNVZG9LMKSVU9RWMDVTMCRJKJRDVELKQTOYTFDPRSLAQDAOVJCNYFTKBELWFNKHSRCTFNIZPRNLGCVBJAUISSINZKCKYBOMOMMXVENZEGUDGGLWZGMB9HFIDQWVHWIQNYRDUSGDMGPVVPFFVJVFYOUWKPKLIR9KTBMYFMLEXBMVIUACX9IEKDKS9ESEH9JGGEQA9HXQLNJHWEOKQFELBAMCCN9HFIPNCRNALVXPHBEIIKMH9CUINWPX9PHI9DGMDSGYFSDZ9NSKDCHZXJGXCHQZSEQMBKDGS9FNVXTEZWZWVRTAGTDCFLTCUUBSWCQDWZWCXUMNRZHYYCZEWZMWCQDXWHMLDPDJZQQWPUZP9BYIKMIB9KXINAXJUWCOZQULI9JLCRNPXMMBOVXHZJBGOACHGECIVHUHPRFYOZLCSGFUOJPFSFKQDCERJKVWVHYFCZEEVSPDRSMMNCNQEVUSTZDYTQJXKRRXHCYKSLKKDFVTTJZMZYYHUOPUE9VXDFYUDLVQ9OHRBMXPUMSMVVUAMUNXWG9SXBP9GZPRUDVOQKT9WMVP9LJ9HRJUF9VHJJLOLLMIZPJWRMIJRVKSTFMSIHZKCRCZMTRRAXMYSOSIQWHGMKJPDFADVCLNJWZRAWT9UWEJBGWRPMURTMXMOYBVUXQFADPGMTTNYGCQTVXWMGHWUA9XOORNTLDZDOXXOHTYG9TNBUHO9WYSMHPFZXFWYRVPUEZ9X9RXTIKCXFECAZWINUCYZZNPBIBRLLNASHNHBEYKJKYDFMOYOJVGZTDYOGRXZLUNHGKVHDMEZOYNFQZTEHPIMPFFLQGZJKAQMBTCKUKLVIDMRPUDYYNDUVDEHDUSXLDZXAIEFHMPLI9R9TXANHAKIWJVSCLXWVTEOQFFLWRHUDTDKSSYPUBPSZSAOLIR9XDAXEHUDERTUAIMTTYGNYBFXLJOYYFNQQXGSBQCATYEPMFLJSPUGXXNLXWHLA9PPKDODBJBELVTCBSBPCMYHTJNVAHMVFQAWEQQGUYPTCD9ZXXSI9MZUYLUJXQ9GFNLIQUDMAIQPBPZTRZKAERMZZKKJZZUMVMBXAGMPSESKRWUIMMMCN9CLAOCKQFOGNMACWYLEIRNKUAB9IIWUIKYHPGTRITMXFNJWDJDFWKCRRWZJSUYJDCEEJHVEJZWFPQLNTK9SIINXNFOI9DJEGMRRNFUZMSGKZZWXPRY9PQPQPLNRBDX99JBNZZGPYDNRDHEYKMZVYUIYVLKQHGYHFEFC9LMKYJWQQQZVYVMFQDEKYPE9RETZN9BMXFBGVPDKNSWSCNFHVPPBVQKWMKCQEOWGURJIKCXFDSSJDLGQHQ9WQ9KUNBAAQAUPBGLGGBIKANVDLGHFHKJQEOWKXV9TZQEXZZZUFOAC9ZOVPKTQZZASSWCTSLGQCPPBATPLMRXBLBCNXZTGFFNCMAUIZDRADNH9VGTP9LXNTSKCULPS9AYEMCWXFCLGHXHIGORKZGMEXLD9DOAZWLHXGYUWQAHOEGDSHTYUSGLI9OGFWIQTIAWAIA9TNVOZ9REWUPCZJEXAS9IDSYOJ9VDTAIOXHLEIOKNXUPNZ9DVOXRZXYOBKWARQLVCWIIDTUAFOYRYCIKAQCRSIXDDJYRKUD9RAVIUWJHXQYVCENPAIS9SACTKEOANWDJEJRDSFPIPDMSWFHUZ9VXIDGULVZOCOUDZEHFWPTUJDES9KGFHXTYZMQMEMZ9KQVD9JDHPOJKICKYSTGGQPDV9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999C9UGNCD99B99999999B99999999ZFEEOXZLETROCWIVDZUOGYLJLSLIJUDHGABDQZDSWXBPPUZBZGJBJNUMTQ9RBLZSIPNANNVX9IXPHSOIDXIUXCLADNORUPLPYKKZ99EXWHIQCEIHBNFVPKTOZXQWQBX9DLJWAAEFOLGCFONKCDXYOKREFNMGPZ99999IQ9APLWCWMCWJVQLPVDUH9WTVBZWM9XPMCQOIYABZTEQKNAHU9FFUUEUUNQQUMSGXIMZLY9ARGK99999999999999999999999999999999HKQCVQQQF999999999K99999999DYQE999999CJSYA999999999999";

        generic_validate_milestone::<Kerl>(
            MS_HASH,
            [MS_TX_0_TRYTES, MS_TX_1_TRYTES, MS_TX_2_TRYTES].to_vec(),
            24,
            1_367_702,
        );
    }

    #[test]
    fn validate_milestone_mainnet_1368168_test() {
        const MS_HASH: &str = "WVGZCTTHRCGZVFFTXQCLXLHPYY9ZUBYFDZQBUFCKSKSGBVGOQBDEX9XPKY9YFAACRCZAYILNGIKGA9999";
        const MS_TX_0_TRYTES: &str = "ARERS9WQSHVFSQCRUFKXYKRQXPLLNJJFNCRDXMUHJKUPRYWYIMPZ9ZT9GXGUAPZOCPFKRZMVTXMKGBUKBGYLWDNCIKNPSPBTAVLBQLKBFLBGBGNEUELSIQ9POHBKOGMMEOU9COTNIAYXNJYAWSUJJHXJMWTAYJQOPXQMCVZTZANXJKAOWCQWGECEPQPGEQSHIJBUYNWSMCLZ9XQRBHKXYUKUQFJLJQNUAUHWUVRPXMDHIBZRGRCIZDYVVJKJIT9P9AHMXCEWXWPPNNIYDVZZKDSSYZMIOBEWLITCRNNIVBFBBPKHVOXM9WAQZHVBXEMMSVZBLTJRHAWHJUGHLKWHHDIZGVTXZORGARTWAOZWKOYQBMINVDKQRVUSYQJUPQLOSVQMYDIMZQHGTIGI9FXNCARXCHXW9IZ9WVWWSVCPIEAJRLFRIINBW9QEFPJAQVYNVUREZSLCNYWU9OKCKODECSSEJBGTPBLXQWMSRXFREJVQUJPVHPPJF9NDFMDMVDFVBDNS9MIYBESUIHHFAICOIFNRPLFERQDQMPSETOKWOVJIYWIFKWA9NSASHEHDYFVXYBQQBYBGXHNUHSXNWOMWUEHMZXYTULRKAWSM9SVKDVRLDNOQGGWEZGGBKSQFJBABLUXFQLIZUXCSMYMQDQQKDRNYMFSCKFLABVZBCJTXLNTKDRLZPCFCRGK9WRBYZHCIOVBLCYOAKCMIKSZNCTL9MDEQWVVABGJKKGSJ9GLGQSZDADMKDIVCUCZMZBVXVDYIRINOOPLFOECZYXJDWDWBPGIUWWDRAQWXDJWFTOZOVDIQGVQDMRHKQNPYP9T9YNHJGSTAYSFNCLKYLDRVFRKUMPQQDUBHHXASRHSEBRFLBDNPYAIILNBGLNETWFANZPJHPIBZPSSNVTDRSZ9ETFMEKCQIDIUJGXROMNOEGGUNBTMORJGEZLPZCPHZXPUKSMHFXWPIGHVNJWCZRWYJEMHOCONXVIUYJRQUKKNUWXTVTDIKCXYGRNRCJVWODHUPHIUJXXCFHAFJDPEEPRVGK9ZEFWDPVF9HCEUNWPHM9ASK9PBBSUO9FCNZUK9ADINAHXWUNDFQ9TWCSQGUGTIHOUDTHOYNSVBYJ9USTZMSIQLPXRSZKDPQUJWBDRECSPQQVEBCBNVKVYNICMPHOMWHDIBNGGKDFJCMEUWQYMFKYZCDIIQZMYRGAMGZJWLAIOOZQXATLRDHOFGCMEVM9UBOOTQISYJFWWKRKJOAUPNVFIGXLCYPVFQJYSR9LUGZMDPFMCAP9RIXWKQOVLUCSMRWFRSJQWLHOXTZZSXPTVFLFI9OPVJL9M9NSTBQHATADRRJJHCDTYJJONTZHWEO9XSPTYJVL9IENYILTX9HZRXADJCQTWFF9LCTWATYEMJYN9GTEV9JLIUKKPZZNCVJBKCKJZATYAR9SCAGXUNNPAORTWQZDNBHWH9Q9DIUAULBHCABWJRET9MPAOTFUC9XCUJUENDIBIOHPFSVGVHETLGUOMELV9BRDT9N9VCEVLAPB9WOZTBAXYYKYDYHELRIMDCNSEIA9OKHLSMZKHS9PBJTKZQTIUOLMGEJQSFGWICETDGYLNPBYWBJIVGMKWPQXOMOGXRYNKYSDTFWMQYQCYPXCHWJMVYKHFNYXNJVVXROJFUIDMNYWTRTFZFSRHRJ99ILB9AHZUHUKOVLFJV9PBNMDSAISL99UHMBUDMQBRDLXWRALAHNGTNHQXMKZPJQYPSFATIJYVQJT99WFDMXWMUCLEIYVEZEHRDFNAZJAW9HLEBSICCVETLBLCLHGGJUJNECTMJVNONGR9SKBLNMBIFVWUTJUOIEMFIPMEIMEZKZTIZXFVSFSJRCKWDRGXCRJNGGUGNLCMUTUO9TDHCXLNTLZSKDFFUVSCGKMQW9XAZDOPHDFFXPSDRLVUCUDNJLJ9HGVRMBKCCDHFOQFMHTTCPZPABDBTWEAQIK99KERQRNFJAUEXINU9CHJPYRCHJOKJQDRZ9ZHYYBTSKXUGGPZTXJOHCUYIBWCFDKQXCOPPOWHPRYWUPAKHUVSLXWDAYDWQWHOCRABXUQYPYIGJCZGRGRZWDNIEVEMEMKSFZUJPLPNYSES9XAIAABLJKXKTADVGBOGRNFALVJAVKTXVZOYGJPVHINSLWENV9MUMEZDOUDQGYIEAGOUBUIPPND9NBEQSAUZXULTTYZCLNJNTXQTQHOMOFZERHTCGTXOLTVAHKSA9OGAZDEKECURBRIXIJWNPFCQIOVFVVXJVD9999999999999999999999999999XUNPC9999999999999999999999KTSINCD99999999999B99999999Y9ISSRSLZLZLLMMKSIRKOGWQWOBEERLBCEWMTKHRZBYAISGMOYKNI9AWWZUTFK9RN9WNWX9EWRPKIPRKXEDGVOPENSGQBKQKWHZGCDZZLTQ99FW9WZMYWL9YRLRIXKHTEEGPVNNZSOTPJMBWB9GYTEXXJRQVXZ9999FNNTPGZTUBDEDT9IDJC9BNULWYDQZMZCZL9JSYLJBLKJEYMGTY9FKLZMXUDGDBRSNJSNKPCPJ9PHZ9999XUNPC9999999999999999999999PSUALSQQF999999999K99999999TC99999999FFE99999999999999";
        const MS_TX_1_TRYTES: &str = "LQTYW9WICCNSXHKJ9ZPSBVFGHSOKAFHUSQCBXCXWAGKTQWUIPZYBYWDFATXDQN9KWVCEQSRJ9TFLMQLJYJ9JLXBMRPTAXQBFHDWOEIXZEJOZVVZARWRBZLW9RZHAUWLFURFDVNQDJZUDMNIXGUQVXOSPX9FJBHFVAWAHQZZTUPPZQTRYBNSKCC9QLDDZXCHMWCPKXGNG9VHRGYLAFYEIJZYOKODMTOJBSFRSLGAHJTCUWICMLSYPROXP9TABGEKLVAHYFBFCHIKZNNBLGKMQF9RMLFASZXOPSMMEAMOIMPUPBNTW99RTZAKHEBT9YJLWMEKDSI9FSFJGKQZGLXUSWZAKXGPTBEMSKXCZMBZWRNDIGZTGNO9ZCDIJKBWXYTVUEJXNHCMWWDXCWPFKIYKHWGZ9MANWVUWTHQBHFSJHSMJJQUWFSNQEBYSIAIQHO9VOLPZRXCDLAWI9JJ9ZLYZAKSONRAQIZJSYYWAI99RIIICEONQYZQPBYCZVVNEKYMGVUTJVICJQLBWNEFRAFJYBMIZK9HAOSOELWADVPU9EYDBLAEHCULQBQF9M9LAEMPZCAYBTLPAHIJATOOHTGIKMJIBARUPXEBOPLLPRPGBQPOGLNXJVFS9EQWUGSGB9QPYWTEZDWWHCLBIYLWFVRIPIJEPFTLVHEJKTYDNLXADPRWXIAAZFF9SJDUNATCVFCRONFV9VIXQHMFMEYZTCLSPJHMNHDGHOEMUPNVXKAPZSRLV9XLQGUWRJHITXIOJKGVGXRPQ9FNGWQ9BMXDZLS9ZEOSBZLEKPQPPNCUMN9YGPJ9IJNEOCVXG9CWWLZRLHNOX9ZKVAQZRBV9XZYWORDRPWSRJBCDMFXJOYIJWRRNDJVWQUTWUFRXNVIOOWCBZLTCDOHGWCLBMQNAEILN99MGIZAK9FPSDDLUX9WLAJZXPRMTSSUTQIFJWKAAOYMZU9JBLQRVIDXDUXJUICYICZDTIXSETV9SFMD9VYGMQKYPKYDBADGKMWUNBYBRYHHKLVVDZZYWQIPTHSD9QVHHBCJKDSIYYMVAFFZZKWFXENLSLCFDTPXWKJCQZOJBQX9OS9KBKBJKXTZ9KHVYZHWQHNYMOG9FZZXQJZUXKXDNEVBXJIIKTVQCNLSGZCRYVIOX9ZYOIGLGJAZKLZDWCYJOIBVHCXRFKNBGMIRYHANWYXO9QDAGZWHDPUJFNXDEEZQEWUYTYLFSDZBHLWD9SUATDSIYBATPOLRTQVKFZJLMBSEIREWTQWLBUMEPQOVNLBVRUVWDMWYASMQMMETQEPMSMWDOO9RKTAHJQIMROSLAJPEMMEALZXRTANHKAWAQWISCVPFJQTNSEOLAFKHOFCFUTGWQDJYXE9AUANEDZUBKFBWEOVJKMK9UKHALOCOGIKEXZLMSSRTH9NCRYJLJKAJOBJOXXMPCWA9XRMQDCJKEIKUMA9KCD9JDOLMZKIZESZGRRKG9TYMYSFLHPGTML9VFCXNSWSQKKYHSMPKUYOOIKTITVSWQKWODAYHYNPZGSHVAMJOOOTIYYQCYLECEZBDXYLDLWYHZLYEPKGKSEVWLQWNSOTQIXZSJWCTG9UCG9F9YXPJRERITVMOD9BHNKKPYWQDFYCIQVLZQSRUYKVMQAGCBIBAKBZVHKUSNTS9NAFGWZTSPMY9IPBFQMTSEOQIJDVYPRS9KKJJUQ9YGVBKCHLXFJVIUHZDKVYZNJDDGIWKPGWGKIWDTMJCAHLTWHNOKYSGMJABMOMBNOCNDTGFIWQPVBMHVRQZPQIRVPE99HCOD9WUAMJTGZTSMZKJCYDSNIOMKJNDDNQSOPBTFQVXSWLXTKQOWCIXADDH9THFXZHYMXPLOOFPHLNMJX9JRXAEZBYTOLVMWEHXXTKJX9WXRGNBOBGMI9JLKRZCGQIXZNPS9SRVFNELNDVCQXMIRALWVDUKYKJGROCOBISSNHXIEYBRZATWTARXBMGQUNOKUSKREIKLLRWVDAIHDRQAGAOXMPCRTHOTCZTNSTKNIEXUXVT9MDJCGITLGYBHNTRFRRCYLNZBITGTZCAEGGOOWYFDQTUCNSXURCSPAK9NVQXXTCBZBEOAZ9ZAWVGSNHRWNEDHDFSJMCAD9QR9UK9L9WWFCDMXOEODAJCRFGUBGHLZPAPBOINH9AMUNPAXBCONEY9ICDLUYOEBCOOEQNAFNXEQSAUZXULTTYZCLNJNTXQTQHOMOFZERHTCGTXOLTVAHKSA9OGAZDEKECURBRIXIJWNPFCQIOVFVVXJVD9999999999999999999999999999XUNPC9999999999999999999999KTSINCD99A99999999B99999999Y9ISSRSLZLZLLMMKSIRKOGWQWOBEERLBCEWMTKHRZBYAISGMOYKNI9AWWZUTFK9RN9WNWX9EWRPKIPRKXECORCDYZCCACLXWTITI9KHKLTRXOLPEWZTJQPOCCABKXJFVPKTLATSSQOBLEOPJFPIPSEVICPEDIZ9999FNNTPGZTUBDEDT9IDJC9BNULWYDQZMZCZL9JSYLJBLKJEYMGTY9FKLZMXUDGDBRSNJSNKPCPJ9PHZ9999XUNPC9999999999999999999999OOUALSQQF999999999K99999999CIC9999999IRB99999999999999";
        const MS_TX_2_TRYTES: &str = "XDMVCAPESXMUHIGEDUPPJDOORJAULRSW9RKFBUTLFFPWQSMPGJMJZDRSBOTPUHVSJJX99AKMHCXI9FLJXSFXWIRU9VKKJNGOXM9YPLWYO9TPWEEJJGYESDFEVYYAQXRYTVBSURZICAJXOQGBFWGUYTNQDZAVUPAKBYVUTLQBCQHAKK9TFFJ9UFTGZFJTWXMZWMMNTXISTPLEYFRRFCQSDKDDBXWNOMWVNXYOEG9ASXNHZVVWMDCLDPLIIBLMACFHXFVNSQAXROGJAOMRFOZRSW9KHEPGUYDTKPYLIBWZDOEDOMPJIKGGUVZKBBCZHXADGRXYPYHTG9E9ILSGPXS9LLXB9AXSAOHF99MFKLLTXRHDLHAFWTNCNTNVOPB9AXDH9LHJXJAQOLIQUTBEVGLCBVDCSICFBTAHIMNZDYTZMLJRTAEIESSPJKNGVLJUQIFDV9BTYHYYJJVKCKMAZPBGRATESLWHBPSRNJZQVXWWWHMWYW9EQXZNVCMWQYJJGGPZMPAFGPNOUMXJKIFYICOPRMEARUZE9UVFMBNZEY99AYS99GNUZBYYGXXGVJNVFIVUSYJLJRBSJZXDIIYPSJNXAYKTJXGHTQ9CTYXTK9LGHWYZJWKXMLV9PORLXOPEMNDPGR9DNQGWESKKZQU9JORJOIHJKFKAKWHFINGOQOONOORENUDLTKJZVEXEDWKVTVCYKQXDABRYXEKBCMWHHCVZ9VDTXOZQEUOTWQFBKHJVIFDCAIO99QSUMYRGIM9MEHQGCUHUGEEFZHSJIWIFKSYSKZSDECULLZINGIDVLEPEQWPUIZYVLYARIXWKCJTOGYDCSARXCAGCLIKG9YREIYAZYZIGRBVQHANDLMQSVCDXHYJRCTQXYEXOC9RZBNZAM9PRRPKYWLJNDKTPKZTHDEAFBGZMBWMERCRRSTGONOAFCILFGZDXHTIVRLJHCEPGZZCYACKKQHMYGINXMVGEJDOVCEHH9VCOKMJCYXTYTUMUESMFUWKJNKVHGZKGABNAYSVDRPGPGDOTVPTWFSNFZZQEND9BMKMJZPPJAEHGAZELMWZDCTSEJMLPITJVKYNGOAYYZRWKIKPJMHAWBOJXIOTEMIJRCSSSLAIEBUTHOOOLPQXJVWPTCD9ZXXSI9MZUYLUJXQ9GFNLIQUDMAIQPBPZTRZKAERMZZKKJZZUMVMBXAGMPSESKRWUIMMMCN9CLAOCKQFOGNMACWYLEIRNKUAB9IIWUIKYHPGTRITMXFNJWDJDFWKCRRWZJSUYJDCEEJHVEJZWFPQLNTK9SIINXNFOI9DJEGMRRNFUZMSGKZZWXPRY9PQPQPLNRBDX99JBNZZGPYDNRDHEYKMZVYUIYVLKQHGYHFEFC9LMKYJWQQQZVYVMFQDEKYPE9RETZN9BMXFBGVPDKNSWSCNFHVPPBVQKWMKCQEOWGURJIKCXFDSSJDLGQHQ9WQ9KUNBAAQAUPBGLGGBIKANVDLGHFHKJQEOWKXV9TZQEXZZZUFOAC9ZOVPKTQZZASSWCTSLGQCPPBATPLMRXBLBCNXZTGFFNCMAUIZDRADNH9VGTP9LXNTSKCULPS9AYEMCWXFCLGHXHIGORKZGMEXLD9DOAZWLHXGYUWQAHOEGDSHTYUSGLI9OGFWIQTIAWAIA9TNVOZ9REWUPCZJEXAS9IDSYOJ9VDTAIOXHLEIOKNXUPNZ9DVOXRZXYOBKWARQLVCWIIDTUAFOYRYCIKAQCRSIXDDJYRKUD9RAVIUWJHXQYVCENPAIS9SACTKEOANWDJEJRDSFPIPDMSWFHUZ9VXIDGULVZOCOUDZEHFWPTUJDES9KGFHXTYZMQMEMZ9KQVD9JDHPOJKICKYSTGGQPDV9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999KTSINCD99B99999999B99999999Y9ISSRSLZLZLLMMKSIRKOGWQWOBEERLBCEWMTKHRZBYAISGMOYKNI9AWWZUTFK9RN9WNWX9EWRPKIPRKXFNNTPGZTUBDEDT9IDJC9BNULWYDQZMZCZL9JSYLJBLKJEYMGTY9FKLZMXUDGDBRSNJSNKPCPJ9PHZ9999QQRLMEAUHYDSMWSRVYCPMHWSIETZHLKMY9RTDJPO9DLXLGBJKWZBEPPKWWYDV9NWUJOKFRLXRHSIZ9999999999999999999999999999999MDSALSQQF999999999K99999999GBD99999999XSA9999999999999";

        generic_validate_milestone::<Kerl>(
            MS_HASH,
            [MS_TX_0_TRYTES, MS_TX_1_TRYTES, MS_TX_2_TRYTES].to_vec(),
            24,
            1_368_168,
        );
    }

    #[test]
    fn validate_milestone_testnet_1537978_test() {
        const MS_HASH: &str = "WBPOUMEBNFEBYBZIOCJURQJPIAZFDBKFU9HDLMPIJNRHICW9HHLDFQHHTJU9AQLUSE99UEMWMPB9UW999";
        const MS_TX_0_TRYTES: &str = "DMKQFAUSVGRSZQNELTJRWODMD9TTOMQJWPUOITLNGCPGLSJRGTLGWFVJCKTYNFIZDLWOMYWXX9EGVJEQE9TLKBBIFDKCQFIVGLMHAUZBVEACANJUYLCGUZYCCANSARQGFKGJRVYVYRLRMYDC9QAUDSUJBRJWBGNBOWCZRDY9AKHQVKEBBTBWAZ9UDKHMCGFEWUKYIGKXV99SYBOGSAWHIKLXPWGIXDLALVQUTCZBTHOEANLNRFJILYFQVAJLAEHFAHMRHRPQKKF9QZWQROPHKZISLCWWMHPKOPCZDJOGCELDIAMAQVFDJWVGINGKXQMC9EGVTWZWNQO9DPGIBCNIPEWBPWMKOGIHJIMGGTVCCHVJENYGAWAJCLNL9ET9SDFIDTRWW9ZCACKKHDQFRKAGN9TKXLPSTNY9RCYXEGWPEYHBHANAYXTWVKOJIWXGETTZTBLPNBVLTQJYBHTULDYYGIMPQQSWPEKXXRWCXAXBYKKGAPDVLD9WSZKFJPXRGTSQHUWWHFZNMZKYLKKHFUFTPUOTGBSZ99OZHGEQHQJLLPLIAWRISRDNFJFIBBOMBFEECUCVFIVWMEHQKQQNUCBQQDXKDYLA9YBWGBKBPERFGWUAFTVLUYF99BEGKJVKBACCZKG9RAFFTQATDDKZNULZRCVHTX9TOBFZVGIRTAIYLIYYTBLPMFJCBOZISCVPOHUIRBIPDXLAUUTUXROBVNTMUSBKUOPXXKING9WLNIDITMORTYHGIFLQQYLZIUKOGVIKVNZHLVYUBEWTDNDXFY9C9REOTWETTQEOBUVCSOUXMJXCCFXQUNOO9XATXCUVRAKDEWNPSWYRUASAFPGFACEXBYUPCCWXBZNPPBWFCTMSLGZEJNGANJSWQUHHTRKUOXOFPZZ9TFMAZNLUUYRJSSRPBGEVPWJDUSZIVIFICSFDIOYTOVDVSMZKDDDBEIDXQCYOQUEJVFWTHROUKXHJUXKGLDAGLYJ9A9UCMAOSKG9GDAVJIGMVWSJSWJOIWFKNQXBQGYWAVMSPYVQEWBAZDQP9WBFIOAGEXRGMA9UPUTTLAAXLXQZ9UWGXBDYD9GYDKSAWXEXYJQLTVDHIBNGJBYMHMKFBNITLAOUCHWEELDQZNHUOIECWNAUSPTKASQORFANKRPLOJVPFDWBCVXBJNRCXEGSYGVVIWV9BCUFUYGA9KODPCNKXJRDRTOEDOPBVVAPMRQKMYM9TJWHXGZVRMEIKV9RBJKAXEAKGVPMFKLPZTQFYWASPXWCJQSHKBMHWJLV9FMPHWLLZLMOQEWJYJ9AE9GLYLYALCZZXOFHFLBPQFKZINFBHXAKGPWZN9LKGWLRPTXMC9CCPQTXVXKABIBOUTJQ9QFWGMUO9EKJJQPNIDYSPGCGMMAFEJRGPCMHLJUBZZQOSOVCSQAXJKGKLKY9VXGWNSCPSSCLKGTXJYIRUWOMARV9QODZJFDEKICLBOSFZBMVD9TXODSBLCJNSDOBXXBACKKBF9YGICKBZTQBD9IFPIMBDHJOH9RFPRQVV9YKYXWDQTIMPAVDCLCH9HFFNZDPIQYDLDZYTYAHOQDCWLWJOZXIORATCHNAJEPHVLVOYPIEVXTT99MNRTYTNSEJ99RGADLBUGCYHCVCCPZACKLJOMCOUWWZYIYCVSWQIJFKMXHXBTNEYF9QPKSBPGOWEDE9VXINADHDNNDBBABCTHXFAUGHE9AAUCINTTSVOKYHH9DJUATDNLE9CTHVOJ9S9GXBZPPDGMVORHQJVHIAV9KTZVHFDOXKXRQRFDHGGTAETGMZQXDEZVFJPFCUT9VRITPEWYNCXOYQAXWGMQUKAT9XZAXZZHPTSPNZGBICFJFPFEWCMOJRNPFVNU9ZKZCELHXVANEYYQDRPZUESXHCXPNLIYFNSTDPRTJHQDGKO9VWTGRBGCKKSTOVARRVNRBUC9AJNHAWG9QNBLJRV9FRVLAJCVTVCQSH9ILMYEKMPSZCPUOJZWKTPGRQMQOLPHNQVAXRKVRRCHUUIRDJWZQKCFIUYXGPWWAJQCEBLZOBXCIDFHSAVIVX9WNDHJMRKETTHAQYWQKFGWJAFKDSF9JLKDTKMMJVTLACARQ9GEYNNUJWL9FSIUUQRRU9M9JTWDSRQZCKDJUINRCIJZOBWLBHWFHDIAZSEUQJJFMTEWKOBXRBWILPRFFKUCADEQQFCZBIHRHWPXKMTOLMYUYPCN9XLMJPYZVFJSAY9FQHCCLWTOLLUGKKMXYFDBOOYFBLBI9WUEILGECYM999999999999999999999999999DSDXC9999999999999999999999BOVVOCD99999999999A99999999BQ9DJKCANKFLLWUQWXRTCLJIDDXBITXPXRSCZYXWTDVKRXBUMQPXYJ9NTRYITORKLDLZZZISHMWWIPUBXOBTEUNGBPJYLXKKOZHSO9GUDAEOCKTSRNTMOLPPEUMDRUHJASKUNMJSKTYFHNBZOHYQPJVVUP9ORQV999DXNHWYGWUWAMFOHPZSRLSAUYZFICFVLYQNWVCEUMSCDEMKMSRQHPSYZYMOOBOCMQURGPFYQUUKJHZX999DSDXC9999999999999999999999999999999999999999999999999IC9FPEMPCERPJOBYIDIHBLRMBYN";
        const MS_TX_1_TRYTES: &str = "OVYIFNGNCEVWITIQTGMXJMTICGOEEAOJBIAEORROOFDWSYS9OJDNLQDJGYCBEOLDSEEUYRRAYUDBAHSATWKTQX9VAAQZWGI9ECQFWEEPMAHXF9HFREEICCCMUDVREBNYTCUEAALJ9DK9GLZCQKBRJGBUSGXTNERTIAEPWIDSKYVINHEGITCB9CZQWWFCDEJRJGS9VZWEBMBXB9DHXF9BDJJZX9GAXUGQGZHPCFMJVJAVXJRFJMCZMVCPAKUFFJACHTLSDEWL9AECTJDPCPECKXWWEVGSETJ9OCHUQBPXCIBAZDRIITSBFZECFVWTESLBWFJZQYKWXSTRIISYNVIGWGCWFTGIKHNWUDPKM9HK9XRPYWPDHXR9FWEJYVNT9VDUJLXTGWXKQYLBBHFA9PPFBBFSTCRFAHUVJUMTDGGYPO9QVZIXEXBXGX9GBHFQPLMUYOCCGVOTNSFHGADXRTQNYDMGPXKOWMXVOVZRFSVWFKSGSRKKZGXSLEGVGJ9NKECAUUGKZYDRWFOYVHLSGRFYGNK9GSNCCEYPFUJTVLGGJMSETCVMMFAYQEZ9RAG9NNEBWOVVOCFWNXAKGWSZRAIEKYFCBBIFMDBAHFUFOTLRJ9AHKIWDCEYTWUPAQHSADDSPYHZXVPFFDYENVOMWSMOWPPULQH9PQBEDNJBJKQJPBQAXYEJOJZECDEYVSHJUBVBOWNIAYJVMYAJNZRVJIKYJASFTVWPVQMNZRNRKZGCIUEBTHAKHOYEQVXPEBYCFGJZPYVDDYYIEFKWKWFHDHHSFWQBOSFCMVOXVVMACZLEFSCHKBTGATVXOAFLINW9KUPIOVIYIAXMDKUDEL9FSYPOSDLQWCVCPLZVC9PEVLFEZQYVBFVTMWLJATNYPBPGJBQEW9EBYFSCRXVCLTQKLATJWNTRECIRLEPBLAXIUSEARRXRBCAAYN9PVMSYCHVSQBBDKIZSMQVKVZACW9GAQWLIOPUJPTXELIKRZAFQXBUBT9PHKNQ9HYXDSHDDAUMGDWGMMMXBOJOKQ9RLKK9MDZCGTSABSMUIRKRSHMZTHJZDGLFURJUQ9YSOCSLWARTRCUVOAIRBKGZUQSFPYYFGKQGQBULZUSGJOGMPUKBRSJLFGJBLROVKALACPXKVUEWONLPM9UHHFLGJHHCSIAJOHTKBMAKGKCCCYCKQXIDRGKFUKDDUUPNSJX9OLPIQJDYVATIKGBCZRBJULWCUBWI9WOPNNKOGJCCNMHVMIQQUOUJJMLU9AQBJKZIJDLBNYI9P9XDQFJZTBMYDATVPOFSHZHAWXFWUSPWSFGKCGTZOJNCUYXLODIRVHU9YZZMQVSCEPCKTPRBBKNTRPMYMKJFYPMSVQVSPGCLKBYFIFVMZJYBFGCKDISWXACBUNCMKZVTB9QSBUYMDNXTL9LGESQJABHPEGWBAJVZPVBPVFCCFZZKRITJIMOKQJV9TDVVBOFBAMUIGSFQPCM9EDO9NLJ9BRKHBFCMOFTXDONHGRQX9FIPEGHSAYSYLKHVWLHBNBPLJAFDFHXGKIWPINBQTYMHOUPTUYDSHUQRHBKBOWIJZDMM9NXENLIO9DTVAGIRXKQIPALUSBZWHQT9DOPTZXBPXUD9KGNGVVNE9VIFNNHBGUZWVUZYSOOOHKSKTSVWHKRIRJGCKYRSASHFNN9HOAHXZIFLOPEZWNBYFRLNRRSNGOBKHGVPYEFWGDWAZBPXZKYWEZUFXXOOQUSWZDGLCDINETZRBFBFBYYXBIORDC9LCZWGCXHVKHZXLH9ZFA9A999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999BOVVOCD99A99999999A99999999BQ9DJKCANKFLLWUQWXRTCLJIDDXBITXPXRSCZYXWTDVKRXBUMQPXYJ9NTRYITORKLDLZZZISHMWWIPUBXDXNHWYGWUWAMFOHPZSRLSAUYZFICFVLYQNWVCEUMSCDEMKMSRQHPSYZYMOOBOCMQURGPFYQUUKJHZX999DXNHWYGWUWAMFOHPZSRLSAUYZFICFVLYQNWVCEUMSCDEMKMSRQHPSYZYMOOBOCMQURGPFYQUUKJHZX9999999999999999999999999999999PMIKJQQF999999999999999999LSUHKG9VTVW9YIXEGRNBFNGFXGY";

        generic_validate_milestone::<CurlP27>(MS_HASH, [MS_TX_0_TRYTES, MS_TX_1_TRYTES].to_vec(), 23, 1_537_978);
    }

    #[test]
    fn validate_milestone_testnet_1538144_test() {
        const MS_HASH: &str = "SGPMGFZEUPMUCSAHLGDDCVXDIIVDUPMUE9KTEII9BEQWVA9ORJHOZFFPKGIXBTLJOWKAWSRPJJ9YAF999";
        const MS_TX_0_TRYTES: &str = "YDNJTVLA9BUIUXDBZHRLZNIWROI9FOCFKEM9PGCNDISAHYDGGCEIGIVBEFYKGUYRCDNMGIWDOSTSJVWWOKVTKTNXZGSTYNA9JWHQRVDAX9M9WENRIUAOXVJLZZLIBLEVYFTZMCYEBXSOMSPMPNYAGE9HPBVCUOLTAAQLFGXJPHADXLQVIAZYDDHGQYRODGSTHQXDTQRYSQHNRJSVFLWPVRB9QIIEZTNAXQKBXFZAIEWCSMNUG9LXTUHGPSEVAOTFSIOJX9ILBVGOKQPVBUKAXWBCMLCWO9TDWRAJDYBTDCDILDYMMKEV99YZJPOEIEHAPRC9IXMXSXJXXGJFYXYTAJXBBPUIDMSYGSJ9QSLZAYURMVELPTCECLTGWGJLIWAUHUDEGLDHZMHRLDNMKDPCNUANIOJWSFMTZGYCYKZLQWKQXEWDPPVCPQIWWMWAEKRGAJGZUCF9SNNCJFMONTJLEKOGHPARGOSMCNBCDLZPIUPWYBFHILTJXMPCHHBXUUVLCQZCGWPPT9ZLSPQWNEHR9JCC9UQQQMRMPVMDMQQAHEOMGLNZBQRDYOJAA9YFBJVKRUWLNITOFORGQCBAM9MGTIKIHTXWHD9HVLCQAGFNWZ9SWCDR9AHWBBFLWTIYO9NSDHWXEVIDLTAESFXYEFTZMCVMOYFE9SXILGZED9MZQJQIQMWCVATAKGVLBBE9RBZCGCPLVGFZDFLXHEGQUGDCIBDSAVDOBBNAMRBEFVQQQCES9XYTBAQBUCVGZYIMDQFBRDMPRHOVVR9CWPTY9XRKNJJ9GVQTVVGTHIAVUNDNHECSKLHXMGLUBWSRIVTYWVOGUGSJALOSUU9DEOXXKXSIPFRICYHXKUIFSOARSBAJZISLUPMUSYSADOIPIGCRFFSZSPVSGRZLDGRGVTNUFHCTMIMLXYICLVNIMZWZPBVSNVUS9YUG9AWL9HZRBSQLSLOS9XJQCTAMAPADEBGYMZAXKKKSXHC9GBTVGPB9EPKTOVULORN9JJDQQPSFPRHTGBDDUQKMQYNCIIKFZWJQJTC99UZRZRCXPGZJJNETJSOHJYJCUNQMKLHTTTIKMUFO9XLKDRLWDZYZAFQASYRHHND9TV9BCYXJOMIIYY9MOKGQOKLWASDVLRJOIWYJNBTMFGCPHYPUMUCUBLRABLKFTUKZOPGDCUQHHSAJXDBSE9EGS9VBSZCISCJDKDGZQUDZOZPTRYCKOREPRYCSEMCFSEVOPTCHIPVCDPRDYFXMGBLLQHGWTGKPNHOAECCGVINBYVFWUMNPZWIPYHBWIUELUAYIZVAVFAFMSJPOTYJGLIQGGZPUKNMJLNHSHHJPJUBWLRUXHY9TKQPAEPUCIXLNDIU9XKBGLBVFZCCADYEZNAZFVKBBDSLIYOPCVCQ9QJJ9BJSIIBKIAMQ9EOSDMHKOFE9ETHQBETXLSLLITSZEBRJRTSBJQYRSMIK9UVZQSPFXHBMDMFEGXAMALFNYDTIXMKWROUGUFUQTSVQTLNSOXEFKUYKKKPFPRADSOXEGVNEZSHDKVADMZVJTN9Z9KAYESCCIRQROEZYLOTBPEJNAPDMHIZWTNORTPGZZYWGVMO9TTJXEMLGSFTTROBTOPRPJKPVGFZRYFRJNDJ9ZUIYHBHKNF9GBQWCUO99FWBBTQMNWFTLIRNOFQEGPOLSNLWSIFXSOFYLKA9ONJDUFCCZO9QJEBRYUFTPMWPGELMXNTRHMEDIPLTYLZCNNCQIZLYEGOVSHYSRFWTVORJC9L9OECVHLPS9PQEZGQUBWHGBTIFFDEIHYLSMMPOCILWEYEVFKOTLTNZQWKQUOMLCDTYQWTVWQLIDSOEJLE9NBCIUWXYCQIWJ9XCUIXRVOVWURUEVOSDDKSEPRDXOTZZGBTQYYWKVCEBVQMHLM9PZNPDLOCOGFKHYDXLYMFFJQVMHYIMFEWNICPGOAGMUUPSKUTDYYOQXDNQJQBTMKVQTJSVPRDBRHLUCGGQQRJFXFEVRFIL9GPWMWUW9ATCMYQJT9FLITDZXSBFFSEYLDRDFTYIIUJQX9B9CLBJXSDHRX9QYPHNUASBPMOEJPRAKVCEVHR9VFYOBHVZMBLONNEGTOZOYLOTXJFGRFA9BXICELUZALHWBQQK9OOPOZIOEGTGFXW9XSSFKQPDYBPP9KPSDFUSNNRDDCTGUTIHCCMKKBANKEQQFCZBIHRHWPXKMTOLMYUYPCN9XLMJPYZVFJSAY9FQHCCLWTOLLUGKKMXYFDBOOYFBLBI9WUEILGECYM999999999999999999999999999HYDXC9999999999999999999999WMOWOCD99999999999A99999999ZXBIOUVBMM9KKOSCUVK9E9OVMZFIWNJBEJKYNNBHXAYXWWHZQLXUJLMNYPNPUE9AJACAUKKP9XTYHTZZCQDSDURJUXDENNEJNJHLMNBYZXFXCQLMJDHFUGPYFTJZCWKM9YEKSGPJWAYZZNOKQPUPVYGPUMHRVSH999UADJFMOGKBNBFVWWUUPSPAKXEUEVSOKXWLGSUIFPPDNTOD99QTLH9GWJGZCLSQHKFXODLRYQTUAJMR999HYDXC9999999999999999999999999999999999999999999999999KOCHQZKJMAWGTFXYBRQIVUNSOGM";
        const MS_TX_1_TRYTES: &str = "DAQUGTCYONBKAFUUDUBGADEDJZOHEHINJCQIWUJNJLXMKOEHPPFUPLEZYUNKWDLPLFJRCAUDFUCFJBZWCZMNAUSBWB9OQZBAWZX9FJAAQZSRFHA9ZYUAXOOADHG9KLBPKMNDNUFDPDXATHHOCRESZQVWVBSLCMNPXRWWGSGGCUBM9HLXVQTALABYKEDWZWO9RLMOHB9KKBOSFWAYSFFG9JAAECSIUMABRTHCXEVSZENDFHJJBETBNQG9IRYX9DYESTEARKNB9JZWYPEYMRMVEOVKFHJXIBOFUOMJSTUTMEIYXSBPTAQQBTOYXRIKNRFQSAIHIQIEDERUKMKSFBTQGOYOOPUFYRUKYMMLSGYSFMCPDYMPWNDLPLNZCOWY9VDGOQHADPTNODRGETQODAJJSMJJUCRPOXDMZCXFHLNTHLFBQQPMITCNRHZYEYAS9TYHWTIBERXQMESEUMXMOQRMWXZCPTFNCEVRYXRUQHFY9UB9CQQKUGXOSDWJGVAQDUZWPOUXJONQYWUOZLAPPKFGLVAGPIJDEPIONSGVBKWSYP9CPSFLQYVDAOLIQATNQTUMLYSAESRZVYZA9FKJYEQHQAUW9TMQSXBCTTTCVPBXCYWYNRNPYIKO9YXXXLODS9LERSKDCJCUPZGFCCAZSAWNLPPSXYKSXFVOHPXHSSAYXTCDXHKCSRXOAORXXTDSDCBBTWZELBITDO9JJFRLDFYSWBDNWXRNZCOYHFLDCMZKKRKXMOKPHRYQFSKQARZTLAJUYDGY9JFJVPDHSSQOLRDIEPNAG9K9BXJIWKMITQROVOAENCYCQFJATFLWCIWUYO9DWYLLYEMFYWDKESMLWWLFWHZZMZTRBYLFFYQNUOZQFRVEYTPNIRCJNVFQJ9DLOBDXWGWJHIFFLFSQ9LZOCACFXRXCVFNYYKZ9YYQT9RWYWNHYWGPWYJIGOLKRRJQLZWRNUDBDNDCKTLNF9GAQWLIOPUJPTXELIKRZAFQXBUBT9PHKNQ9HYXDSHDDAUMGDWGMMMXBOJOKQ9RLKK9MDZCGTSABSMUIRKRSHMZTHJZDGLFURJUQ9YSOCSLWARTRCUVOAIRBKGZUQSFPYYFGKQGQBULZUSGJOGMPUKBRSJLFGJBLROVKALACPXKVUEWONLPM9UHHFLGJHHCSIAJOHTKBMAKGKCCCYCKQXIDRGKFUKDDUUPNSJX9OLPIQJDYVATIKGBCZRBJULWCUBWI9WOPNNKOGJCCNMHVMIQQUOUJJMLU9AQBJKZIJDLBNYI9P9XDQFJZTBMYDATVPOFSHZHAWXFWUSPWSFGKCGTZOJNCUYXLODIRVHU9YZZMQVSCEPCKTPRBBKNTRPMYMKJFYPMSVQVSPGCLKBYFIFVMZJYBFGCKDISWXACBUNCMKZVTB9QSBUYMDNXTL9LGESQJABHPEGWBAJVZPVBPVFCCFZZKRITJIMOKQJV9TDVVBOFBAMUIGSFQPCM9EDO9NLJ9BRKHBFCMOFTXDONHGRQX9FIPEGHSAYSYLKHVWLHBNBPLJAFDFHXGKIWPINBQTYMHOUPTUYDSHUQRHBKBOWIJZDMM9NXENLIO9DTVAGIRXKQIPALUSBZWHQT9DOPTZXBPXUD9KGNGVVNE9VIFNNHBGUZWVUZYSOOOHKSKTSVWHKRIRJGCKYRSASHFNN9HOAHXZIFLOPEZWNBYFRLNRRSNGOBKHGVPYEFWGDWAZBPXZKYWEZUFXXOOQUSWZDGLCDINETZRBFBFBYYXBIORDC9LCZWGCXHVKHZXLH9ZFA9A999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999WMOWOCD99A99999999A99999999ZXBIOUVBMM9KKOSCUVK9E9OVMZFIWNJBEJKYNNBHXAYXWWHZQLXUJLMNYPNPUE9AJACAUKKP9XTYHTZZCUADJFMOGKBNBFVWWUUPSPAKXEUEVSOKXWLGSUIFPPDNTOD99QTLH9GWJGZCLSQHKFXODLRYQTUAJMR999UADJFMOGKBNBFVWWUUPSPAKXEUEVSOKXWLGSUIFPPDNTOD99QTLH9GWJGZCLSQHKFXODLRYQTUAJMR999999999999999999999999999999VDFAMKQQF999999999999999999TXWOX9ZSAIRSNSQIJZ99QJVJZJR";

        generic_validate_milestone::<CurlP27>(MS_HASH, [MS_TX_0_TRYTES, MS_TX_1_TRYTES].to_vec(), 23, 1_538_144);
    }

    #[test]
    fn validate_milestone_testnet_1538158_test() {
        const MS_HASH: &str = "SYOSHWVWTBBMBEXKPYYVAPAVSZAIGWZRHQK9ZMJWGCPSUDNMYHY9AQSKPTEAALHUAQAVPQNKYRMZCM999";
        const MS_TX_0_TRYTES: &str = "CQWFPCRMDRDEONRSZDIQOYEHAWIONVQEULVNLLFFRVPK9SDLQTVNNJBJCGBHXDDGEDUVZHXVXKXKM9CQPIOYRWPTKMS9FUITMCZEIUDYEZPGZPZHEBDBDOUIWWMGSTWONFHJULIDFNNUMOOISBCAMNDLQXPJIOXIPCUSYBHZRKANXXPBSAZTINNVRZWMOIPRSKJYHEYNABXFRYAFBLFRBGCBKXFXEFFOSNOTSLCFIQKRAEEEHUZVFDCSQBCOPVVFUHMYKBZQHWXCTLKCKECTNKXVJCLJGEUQAXDCINSZYDRRID9WCIKDLQZDQYTMVEKSYHRKODXEMIDEXIR9ILYZSATOUBFEAZVETEETZNUREXIDDOBASMOWVSTLQQUQKGBEEPNGZJUJWLZEUG9WJBDBLHBTTQZTLTOMQXQEFYLMDNAIQJQHJVIGNDKD9WSIOPICGAWEQZKLRKTYJZIZOPFAQJSWIUBVVTIBTSXILHTLZARJUOMAFHCRNXTLMGYCYYGICYNLECLHZHXDRP9JGTHBDLLNZCKOHZPEFRXHHYGEAUHRPOQMOSRWEFMRDNUCMQETOJOTE9ROJIEYFRFJNDRZHAGCWWPGCXLEFSIJTIQUQLDAUEUIFNQ9EHIRGYXIFPFQSGFD9QCGKMZCQKVXLCAYWAMFHTGTUICZQMXUVPIIAYYBEME9PSNAKEKXQCBGEUASZMEZIXVIRPDZONOXWBCSMCUGWGOHPSOZKCYOVQRUTGQPVSMSHQBQVFLHSDSJEUZVDEEHOYCGOMICWBG9NFAMMJJBDDUKRROWQEKQFHRMUWROWDTNBFTMFYSNSAAEHJPLZIQBEJQGAEMYIK9JYKPIDJNIUYJVISGRXSN9ARNHRMFQJF9SPGSVFHELZ9RTKRFZQLDINPNSHLXESNMLBKGZYPFOWYBUSUIJXVJXAWQDY9VFFAHIMTTSXLZVIMQTFRGBFTDOQWXEFEODHXBPMBYIDKIHVTJRGZEWDMLVSSA9HR9LICMYAEHJIGKSOPXIVPIQSXNKWRDWFMGPTJRHBGMNDNZCBCMMRBLQRWRWCGELQUJYDDLCMPF9ALVFSXVNGOQCOLTLUTECXMDRQIMPIOHJVKTPXJJXCIW9WGNEYLCNDVROOEJNNEGODDDERQIFXKNVXXWVEDYFNNZZWYAZUWSWZPKFMIRQCCDWCIKUFQL9LKLLRILQTVU9ZCLKBBULHTDZSJGLUMCNMMTPZIDYHXEQXCMEZGYAHPWFBZONHJTQIEU9VDPUTURMXBNVMLEWDVI9HBLUOQWIBJNMQSA9KXZQNFMVGXWWKXWT9QFMHBKGCSGA99XVEDMQPFPNDWECQQ9CP9BXBVONXDTMNH9YZHJXJUPEUSRHSXZFA9KNYGVWBSMASI9C9WDJUJSMGRETVUNAGZPCMXTOHSTZIHXNLSGKWPIZXOSXUOEDRDAGFL9UVXNPMPKMSVFFLPSDXMEIQEBKJVPNRLRCGOSXRXOBPJPVAONPHVBLKRJBNZTLSZ9GNL9MPGJSCKCKYEBBTI9UIDX9QPSVWCYENAZMGDAIRHFVFFLFUTFWWOERMJD9VEAERFMOCMZBVJEPRNJ9Q9RQFLJAVUPURJMV9JADAAWAXFPUHMYPXEFSFWO9GYHMZOMUUMJTWJXVEBANPCEFPUSAQPUOSKPSLDRICSSHDXWIRJYLEXOEWVMSQFEMBG9PE9DSMFQKHHXFMIWVJQREDCMWGPZGPWBPKYFLRDNJFNDBFGZJHUBZHPESYEQRBEKZNSJSNFTYRUVMRLKIBZ9ACFHVAIG9SLQMAJGUMEUUTABQTMN9UFZNKXICIEUSOOYYRGDAUKVUCXVSXDNBETDAGFCGJIZNRTBNZAJQXRZSUKWAODVRMBATMXOCOJZRWUXSMGJKFLSCEBCMKZD9AKMQPN9I9YIAUOE9FSGHOIAIBGLGJEBUPRFBHHCNQMUMBOGUDKD9DJHHAYZUCYTQQFYOTNHQIOSDICBGPAZYEXRGVJVQHPUFSEERMCMVMRJHLRZDRPTRBEMPDFPWPUVWFXOFEWFEWAMGRIKIN9W9TENBNLQN9FJBYGDM9AUGDHSXZHSDRKEWQBEBYHUXPYHZGHVKUV9EUZYPKGUBCUSGLIWFUIQYFKTAHJRVLWNFOVDPTGTNSPMBGHXJWVBGLALRWOB9HPWWSO9WVRHUKOATGGNEQQFCZBIHRHWPXKMTOLMYUYPCN9XLMJPYZVFJSAY9FQHCCLWTOLLUGKKMXYFDBOOYFBLBI9WUEILGECYM999999999999999999999999999VZDXC9999999999999999999999WFQWOCD99999999999A99999999JUCUPVRUKJ9PRBSWRSSXRFYYNOUCNQT9IAQQVCCONBLRYSLCYFFN9RVCTDLKKZIJMOFVZJTTBRNCLEACDPMMWLGEPKLLUPCZLKEWLRDINHNSEIBQFFJAUQTFLYU9J9GCAEKFLUGDEGBUXJ9DVRIOGZMEDGSOGDY999KLKYBHUTDJNXKDRAWEFM9RZFNXMBI9JMK9GXUZ9NFZPVU9TJKJMQMMXFNOVCNFUEVN9KNLQRBQURBZ999VZDXC9999999999999999999999999999999999999999999999999USZEWHFRO9PNRJSZRJHETSVG9US";
        const MS_TX_1_TRYTES: &str = "RNJBRNTRNEL9BOWTSNSKLABJKVXOROLULNXCFVXML9EUBGQVKYRUSEAXDGWNYMLUQKYYSYDOPIRRIZVDZBYEYDUKR99OEECPDOVGRDCIERGMLSCPCAZGBOTJRQAYFAXFJFTVZKPQVXFOWBLQBYCC9WNHNVIUXEBFVRAGAFCLOTBYOQQSAGIZMYGBBNNVKVYUMFBNTKBAWGRHNEGKCKFREXBCF9UBKA9SETPARPLHSVQIOXNHLOIDJEKWXBOPBAJJVSSYWCXWBWCBZGKKGOBPMYCSVPUTQYEQLDDMGLUMPAYUFVXTWTMAJLXODZ9MVIMJVJQVIQIEDERUKMKSFBTQGOYOOPUFYRUKYMMLSGYSFMCPDYMPWNDLPLNZCOWY9VDGOQHADPTNODRGETQODAJJSMJJUCRPOXDMZCXFHLNTHLFBQQPMITCNRHZYEYAS9TYHWTIBERXQMESEUMXMOQRMWXZCPTFNCEVRYXRUQHFY9UB9CQQKUGXOSDWJGVAQDUZWPOUXJONQYWUOZLAPPKFGLVAGPIJDEPIONSGVBKWSYP9CPSFLQYVDAOLIQATNQTUMLYSAESRZVYZA9FKJYEQHQAUW9TMQSXBCTTTCVPBXCYWYNRNPYIKO9YXXXLODS9LERSKDCJCUPZGFCCAZSAWNLPPSXYKSXFVOHPXHSSAYXTCDXHKCSRXOAORXXTDSDCBBTWZELBITDO9JJFRLDFYSWBDNWXRNZCOYHFLDCMZKKRKXMOKPHRYQFSKQARZTLAJUYDGY9JFJVPDHSSQOLRDIEPNAG9K9BXJIWKMITQROVOAENCYCQFJATFLWCIWUYO9DWYLLYEMFYWDKESMLWWLFWHZZMZTRBYLFFYQNUOZQFRVEYTPNIRCJNVFQJ9DLOBDXWGWJHIFFLFSQ9LZOCACFXRXCVFNYYKZ9YYQT9RWYWNHYWGPWYJIGOLKRRJQLZWRNUDBDNDCKTLNF9GAQWLIOPUJPTXELIKRZAFQXBUBT9PHKNQ9HYXDSHDDAUMGDWGMMMXBOJOKQ9RLKK9MDZCGTSABSMUIRKRSHMZTHJZDGLFURJUQ9YSOCSLWARTRCUVOAIRBKGZUQSFPYYFGKQGQBULZUSGJOGMPUKBRSJLFGJBLROVKALACPXKVUEWONLPM9UHHFLGJHHCSIAJOHTKBMAKGKCCCYCKQXIDRGKFUKDDUUPNSJX9OLPIQJDYVATIKGBCZRBJULWCUBWI9WOPNNKOGJCCNMHVMIQQUOUJJMLU9AQBJKZIJDLBNYI9P9XDQFJZTBMYDATVPOFSHZHAWXFWUSPWSFGKCGTZOJNCUYXLODIRVHU9YZZMQVSCEPCKTPRBBKNTRPMYMKJFYPMSVQVSPGCLKBYFIFVMZJYBFGCKDISWXACBUNCMKZVTB9QSBUYMDNXTL9LGESQJABHPEGWBAJVZPVBPVFCCFZZKRITJIMOKQJV9TDVVBOFBAMUIGSFQPCM9EDO9NLJ9BRKHBFCMOFTXDONHGRQX9FIPEGHSAYSYLKHVWLHBNBPLJAFDFHXGKIWPINBQTYMHOUPTUYDSHUQRHBKBOWIJZDMM9NXENLIO9DTVAGIRXKQIPALUSBZWHQT9DOPTZXBPXUD9KGNGVVNE9VIFNNHBGUZWVUZYSOOOHKSKTSVWHKRIRJGCKYRSASHFNN9HOAHXZIFLOPEZWNBYFRLNRRSNGOBKHGVPYEFWGDWAZBPXZKYWEZUFXXOOQUSWZDGLCDINETZRBFBFBYYXBIORDC9LCZWGCXHVKHZXLH9ZFA9A999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999WFQWOCD99A99999999A99999999JUCUPVRUKJ9PRBSWRSSXRFYYNOUCNQT9IAQQVCCONBLRYSLCYFFN9RVCTDLKKZIJMOFVZJTTBRNCLEACDKLKYBHUTDJNXKDRAWEFM9RZFNXMBI9JMK9GXUZ9NFZPVU9TJKJMQMMXFNOVCNFUEVN9KNLQRBQURBZ999KLKYBHUTDJNXKDRAWEFM9RZFNXMBI9JMK9GXUZ9NFZPVU9TJKJMQMMXFNOVCNFUEVN9KNLQRBQURBZ999999999999999999999999999999RQSLOLQQF999999999999999999XWBCNXEDXAMHPJRSLJEAFREVGZL";

        generic_validate_milestone::<CurlP27>(MS_HASH, [MS_TX_0_TRYTES, MS_TX_1_TRYTES].to_vec(), 23, 1_538_158);
    }
}
